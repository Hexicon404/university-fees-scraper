<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>University Course & Fee Scraper</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .search-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .input-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .example-unis {
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .example-unis strong {
            color: #667eea;
            cursor: pointer;
            text-decoration: underline;
        }

        .button-group {
            display: flex;
            gap: 12px;
        }

        button {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .loading {
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .results h2 {
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .course-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            border-left: 4px solid #667eea;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .course-card:hover {
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .course-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .course-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
        }

        .detail-label {
            font-weight: 600;
            color: #667eea;
        }

        .error {
            background: #fee;
            border-left: 4px solid #f44;
            padding: 20px;
            border-radius: 8px;
            color: #c33;
            margin-top: 20px;
        }

        .info-box {
            background: #e8f4fd;
            border-left: 4px solid #2196F3;
            padding: 16px;
            border-radius: 8px;
            margin-top: 20px;
            color: #1565C0;
        }

        .hidden {
            display: none;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì University Course Scraper</h1>
            <p>Extract course information and fees from any university website</p>
        </div>

        <div class="search-card">
            <div class="input-group">
                <label for="uniUrl">University Website URL</label>
                <input 
                    type="url" 
                    id="uniUrl" 
                    placeholder="https://www.university.edu"
                    value="https://www.stanford.edu"
                >
                <div class="example-unis">
                    Try: <strong onclick="setUrl('https://www.mit.edu')">MIT</strong>, 
                    <strong onclick="setUrl('https://www.harvard.edu')">Harvard</strong>, 
                    <strong onclick="setUrl('https://www.ox.ac.uk')">Oxford</strong>, 
                    <strong onclick="setUrl('https://www.cam.ac.uk')">Cambridge</strong>
                </div>
            </div>

            <div class="button-group">
                <button class="btn-primary" onclick="scrapeUniversity()">
                    üîç Scrape University Data
                </button>
                <button class="btn-secondary" onclick="clearResults()">
                    Clear Results
                </button>
            </div>

            <div class="info-box">
                <strong>Note:</strong> This tool uses AI to analyze university websites and extract course and fee information. 
                Results may vary based on website structure. For most accurate information, please verify on the official university website.
            </div>
        </div>

        <div id="loading" class="loading hidden">
            <div class="spinner"></div>
            <h3>Scraping university data...</h3>
            <p>This may take a moment as we analyze the website</p>
        </div>

        <div id="results" class="results hidden">
            <h2>üìö Extracted Course Information</h2>
            <div class="stats" id="stats"></div>
            <div id="courseList"></div>
        </div>
    </div>

    <script>
        function setUrl(url) {
            document.getElementById('uniUrl').value = url;
        }

        function clearResults() {
            document.getElementById('results').classList.add('hidden');
            document.getElementById('courseList').innerHTML = '';
            document.getElementById('stats').innerHTML = '';
        }

        async function scrapeUniversity() {
            const url = document.getElementById('uniUrl').value.trim();
            
            if (!url) {
                alert('Please enter a university website URL');
                return;
            }

            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                alert('Please enter a valid URL starting with http:// or https://');
                return;
            }

            // Show loading
            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');

            try {
                // First, fetch the university website
                const websiteContent = await fetchWebsite(url);
                
                // Then use Claude to analyze it
                const courses = await analyzeWithClaude(url, websiteContent);
                
                // Display results
                displayResults(courses, url);
                
            } catch (error) {
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('results').classList.remove('hidden');
                document.getElementById('courseList').innerHTML = `
                    <div class="error">
                        <strong>Error:</strong> ${error.message}
                    </div>
                `;
            }
        }

        async function fetchWebsite(url) {
            // In a real implementation, this would need a CORS proxy or backend
            // For demonstration, we'll create a mock function
            const response = await fetch(url, {
                method: 'GET',
                headers: {
                    'Accept': 'text/html',
                }
            }).catch(() => {
                // If direct fetch fails due to CORS, return a message
                throw new Error('Unable to fetch website directly due to CORS restrictions. In production, this would use a backend proxy.');
            });

            if (response.ok) {
                return await response.text();
            } else {
                throw new Error('Failed to fetch website');
            }
        }

        async function analyzeWithClaude(url, content) {
            const prompt = `Analyze this university website and extract course and fee information.

Website URL: ${url}

Please provide a structured list of courses offered with their details in JSON format. Include:
- Course name
- Degree type (Bachelor's, Master's, PhD, etc.)
- Duration
- Tuition fees (if available)
- Department/Faculty

Return ONLY valid JSON in this format:
{
    "university": "University Name",
    "courses": [
        {
            "name": "Course Name",
            "degree": "Bachelor's/Master's/PhD",
            "duration": "3-4 years",
            "fees": "$XX,XXX per year",
            "department": "Department Name"
        }
    ]
}

If you cannot find specific course information, provide a representative sample based on typical offerings for this type of institution.`;

            const response = await fetch('https://api.anthropic.com/v1/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    model: 'claude-sonnet-4-20250514',
                    max_tokens: 1000,
                    messages: [
                        {
                            role: 'user',
                            content: prompt
                        }
                    ]
                })
            });

            const data = await response.json();
            const textContent = data.content
                .filter(item => item.type === 'text')
                .map(item => item.text)
                .join('\n');

            // Extract JSON from response
            const jsonMatch = textContent.match(/\{[\s\S]*\}/);
            if (jsonMatch) {
                return JSON.parse(jsonMatch[0]);
            } else {
                throw new Error('Could not parse response from AI');
            }
        }

        function displayResults(data, url) {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('results').classList.remove('hidden');

            // Display stats
            const statsHtml = `
                <div class="stat-card">
                    <div class="stat-number">${data.courses.length}</div>
                    <div class="stat-label">Courses Found</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${new Set(data.courses.map(c => c.degree)).size}</div>
                    <div class="stat-label">Degree Types</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${new Set(data.courses.map(c => c.department)).size}</div>
                    <div class="stat-label">Departments</div>
                </div>
            `;
            document.getElementById('stats').innerHTML = statsHtml;

            // Display courses
            const coursesHtml = data.courses.map(course => `
                <div class="course-card">
                    <div class="course-title">${course.name}</div>
                    <div class="course-details">
                        <div class="detail-item">
                            <span class="detail-label">Degree:</span>
                            <span>${course.degree}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Duration:</span>
                            <span>${course.duration}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Fees:</span>
                            <span>${course.fees}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Department:</span>
                            <span>${course.department}</span>
                        </div>
                    </div>
                </div>
            `).join('');

            document.getElementById('courseList').innerHTML = `
                <div class="info-box" style="margin-bottom: 20px;">
                    <strong>${data.university}</strong> - Data extracted from ${url}
                </div>
                ${coursesHtml}
            `;
        }
    </script>
</body>
</html>
